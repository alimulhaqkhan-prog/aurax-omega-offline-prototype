<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Œ© ‚Äì Unified Emotional Continuity Lab (Offline Prototype)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg: #020617;
      --bg-soft: #020617;
      --card: rgba(15,23,42,.94);
      --card-soft: rgba(15,23,42,.86);
      --accent: #eab308;
      --accent-soft: rgba(234,179,8,.14);
      --accent-strong: #facc15;
      --accent-muted: #f97316;
      --border-subtle: rgba(148,163,184,.32);
      --border-strong: rgba(248,250,252,.10);
      --text-main: #e5e7eb;
      --text-soft: #9ca3af;
      --text-soft2: #6b7280;
      --danger: #f97373;
      --good: #4ade80;
      --neutral: #38bdf8;
      --shadow-soft: 0 22px 60px rgba(15,23,42,.88);
      --radius-xl: 26px;
      --radius-lg: 18px;
      --radius-md: 14px;
      --radius-pill: 999px;
      --glass-blur: 18px;
      --transition-fast: .22s ease;
    }
    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
    }
    html,body{
      height:100%;
      width:100%;
      background:
        radial-gradient(120% 140% at 0% 0%, #0f172a 0, #020617 40%, #020617 100%);
      color:var(--text-main);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
                   "Segoe UI", sans-serif;
      -webkit-font-smoothing: antialiased;
    }
    body{
      display:flex;
      justify-content:center;
      align-items:stretch;
      padding:16px;
    }
    .app{
      width:100%;
      max-width:1240px;
      min-height:96vh;
      background: radial-gradient(180% 220% at 10% 0%, rgba(234,179,8,.12) 0, rgba(15,23,42,.98) 34%, #020617 76%);
      border-radius:32px;
      box-shadow: var(--shadow-soft);
      padding:18px 22px 20px 22px;
      display:flex;
      flex-direction:column;
      gap:16px;
      position:relative;
      overflow:hidden;
    }
    .app::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        radial-gradient(210px 210px at 4% 0%,rgba(34,211,238,.20) 0,transparent 55%),
        radial-gradient(260px 260px at 100% 0%,rgba(234,179,8,.22) 0,transparent 55%),
        radial-gradient(300px 380px at 20% 100%,rgba(59,130,246,.22) 0,transparent 55%);
      opacity:.80;
      mix-blend-mode:screen;
      pointer-events:none;
    }
    .app-inner{
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      gap:16px;
      height:100%;
    }

    /* Top bar */
    .topBar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 16px;
      border-radius:var(--radius-xl);
      background:linear-gradient(120deg,rgba(15,23,42,.90),rgba(15,23,42,.85));
      backdrop-filter:blur(16px);
      border:1px solid rgba(148,163,184,.30);
    }
    .brandBlock{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .orb{
      width:40px;
      height:40px;
      border-radius:999px;
      background:
        conic-gradient(from 210deg,#eab308,#22c55e,#38bdf8,#eab308);
      position:relative;
      box-shadow:0 0 40px rgba(234,179,8,.6);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .orb::after{
      content:"Œ©";
      color:#020617;
      font-weight:800;
      font-size:18px;
      text-shadow:0 1px 0 rgba(255,255,255,.8);
    }
    .brandText{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .brandTitle{
      font-weight:650;
      font-size:17px;
      letter-spacing:.04em;
      text-transform:uppercase;
    }
    .brandSubtitle{
      font-size:12px;
      color:var(--text-soft);
    }

    .topRight{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 11px;
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.40);
      background:rgba(15,23,42,.92);
      font-size:11px;
      color:var(--text-soft);
    }
    .pill strong{
      font-size:11px;
      color:var(--accent-strong);
    }
    .pill span.badge{
      padding:2px 6px;
      border-radius:999px;
      background:rgba(34,197,94,.12);
      color:#bbf7d0;
      font-size:10px;
    }
    .topBtn{
      border-radius:var(--radius-pill);
      border:none;
      padding:7px 13px;
      font-size:11px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(15,23,42,.9);
      color:var(--text-soft);
      border:1px solid rgba(148,163,184,.34);
      transition:background var(--transition-fast),transform var(--transition-fast),
                 box-shadow var(--transition-fast),border-color var(--transition-fast);
    }
    .topBtn span.icon{
      font-size:14px;
    }
    .topBtn.primary{
      background:linear-gradient(135deg,#f97316,#eab308);
      color:#020617;
      font-weight:600;
      border-color:transparent;
      box-shadow:0 0 24px rgba(234,179,8,.6);
    }
    .topBtn:hover{
      transform:translateY(-1px);
      box-shadow:0 10px 30px rgba(15,23,42,.80);
      border-color:rgba(248,250,252,.30);
    }

    /* Ethic bar */
    .ethicBar{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-start;
      gap:10px;
      background:linear-gradient(120deg,rgba(15,23,42,.96),rgba(15,23,42,.92));
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,.40);
      padding:10px 14px;
      position:relative;
      overflow:hidden;
    }
    .ethicTag{
      font-size:11px;
      padding:4px 10px;
      border-radius:var(--radius-pill);
      background:rgba(34,197,94,.12);
      color:#bbf7d0;
      border:1px solid rgba(34,197,94,.30);
      white-space:nowrap;
    }
    .ethicCopy{
      font-size:11px;
      color:var(--text-soft);
      max-width:780px;
      line-height:1.5;
    }
    .ethicCopy strong{
      color:var(--accent-strong);
    }

    /* Grid layout */
    .grid{
      flex:1;
      display:grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.8fr);
      gap:14px;
      min-height:0;
    }
    @media (max-width:980px){
      .grid{
        grid-template-columns:1fr;
      }
    }

    .card{
      background:var(--card);
      border-radius:var(--radius-xl);
      border:1px solid var(--border-subtle);
      box-shadow:0 16px 45px rgba(15,23,42,.90);
      padding:12px 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      position:relative;
      overflow:hidden;
    }
    .cardHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:2px;
    }
    .cardTitle{
      font-size:13px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:#cbd5f5;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .cardTitle span.bullet{
      width:7px;
      height:7px;
      border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 12px rgba(234,179,8,.8);
    }
    .cardMeta{
      display:flex;
      gap:8px;
      font-size:10px;
      color:var(--text-soft2);
      align-items:center;
    }
    .chip{
      padding:2px 8px;
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.46);
      font-size:10px;
      color:var(--text-soft2);
      background:rgba(15,23,42,.9);
      white-space:nowrap;
    }
    .chip span.dot{
      display:inline-block;
      width:6px;
      height:6px;
      border-radius:999px;
      margin-right:5px;
      background:var(--neutral);
    }

    /* Console */
    .console{
      border-radius:var(--radius-lg);
      border:1px solid rgba(15,23,42,1);
      background:
        radial-gradient(120% 140% at 0% 0%,rgba(56,189,248,.16) 0,rgba(15,23,42,.98) 40%,rgba(15,23,42,.98) 100%);
      padding:9px 10px;
      font-family:"JetBrains Mono","SF Mono",ui-monospace,Menlo,Consolas,monospace;
      font-size:11px;
      color:#e5e7eb;
      height:180px;
      overflow:auto;
      scrollbar-width:thin;
      scrollbar-color:rgba(148,163,184,.6) transparent;
    }
    .console::-webkit-scrollbar{
      width:6px;
    }
    .console::-webkit-scrollbar-thumb{
      background:rgba(148,163,184,.55);
      border-radius:999px;
    }
    .logLine{
      margin-bottom:2px;
      white-space:pre-wrap;
    }
    .logPrefix{
      color:#64748b;
    }
    .logTag{
      color:#22c55e;
    }
    .logWarn{color:#fbbf24;}
    .logSys{color:#38bdf8;}

    /* Metrics row */
    .metrics{
      display:grid;
      grid-template-columns:repeat(4,minmax(0,1fr));
      gap:8px;
      margin-top:4px;
    }
    @media (max-width:980px){
      .metrics{grid-template-columns:repeat(2,minmax(0,1fr));}
    }
    .metricCard{
      border-radius:var(--radius-md);
      border:1px solid rgba(148,163,184,.34);
      background:rgba(15,23,42,.96);
      padding:7px 9px;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .metricLabel{
      font-size:10px;
      color:var(--text-soft2);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .metricValue{
      font-size:16px;
      font-weight:650;
      letter-spacing:.02em;
    }
    .metricSub{
      font-size:10px;
      color:var(--text-soft);
    }

    .gauge{
      position:relative;
      height:6px;
      border-radius:999px;
      background:rgba(15,23,42,1);
      overflow:hidden;
      margin-top:3px;
    }
    .gaugeFill{
      position:absolute;
      inset:0;
      width:40%;
      border-radius:999px;
      background:linear-gradient(90deg,#f97316,#eab308,#22c55e);
      transform-origin:left center;
      transform:scaleX(.4);
      transition:transform .25s ease-out;
    }

    /* Equation panel */
    .equationPanel{
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,.45);
      padding:9px 10px;
      background:linear-gradient(135deg,rgba(15,23,42,.96),rgba(15,23,42,.94));
      display:grid;
      grid-template-columns:minmax(0,1.5fr) minmax(0,1.3fr);
      gap:10px;
      margin-top:4px;
    }
    @media (max-width:900px){
      .equationPanel{
        grid-template-columns:1fr;
      }
    }
    .eqMain{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .eqFormula{
      font-family:"JetBrains Mono","SF Mono",ui-monospace,Menlo,Consolas,monospace;
      font-size:11px;
      border-radius:var(--radius-md);
      background:rgba(15,23,42,.96);
      border:1px solid rgba(148,163,184,.50);
      padding:8px 8px;
      line-height:1.5;
    }
    .eqFormula span.emph{
      color:var(--accent-strong);
    }
    .eqCaption{
      font-size:10px;
      color:var(--text-soft);
      line-height:1.5;
    }

    .eqControls{
      display:flex;
      flex-direction:column;
      gap:6px;
      font-size:11px;
      color:var(--text-soft);
    }
    .sliderRow{
      display:flex;
      align-items:center;
      gap:6px;
    }
    .sliderRow label{
      width:60px;
      font-size:10px;
      color:var(--text-soft);
    }
    .sliderRow input[type="range"]{
      flex:1;
      accent-color:var(--accent-strong);
    }
    .sliderVal{
      width:32px;
      text-align:right;
      font-size:11px;
      color:#e5e7eb;
    }
    .eqGaugeRow{
      margin-top:2px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .eqGaugeLabel{
      font-size:10px;
      color:var(--text-soft);
    }
    .eqGaugeBubble{
      min-width:64px;
      padding:4px 8px;
      border-radius:var(--radius-pill);
      font-size:11px;
      text-align:center;
      font-weight:600;
      border:1px solid rgba(248,250,252,.24);
      background:radial-gradient(circle at 0 0,rgba(234,179,8,.35),rgba(15,23,42,1));
    }

    /* Theory switcher */
    .theorySwitch{
      margin-top:8px;
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,.45);
      background:var(--card-soft);
      padding:8px 9px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .theoryTabs{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .theoryBtn{
      font-size:10px;
      padding:4px 9px;
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.50);
      color:var(--text-soft);
      background:rgba(15,23,42,.95);
      cursor:pointer;
      transition:background var(--transition-fast),border-color var(--transition-fast),
                 color var(--transition-fast),transform var(--transition-fast);
      white-space:nowrap;
    }
    .theoryBtn.active{
      background:linear-gradient(120deg,#f97316,#eab308);
      color:#020617;
      border-color:transparent;
      transform:translateY(-1px);
    }
    .theoryBody{
      font-size:10px;
      color:var(--text-soft);
      line-height:1.6;
      margin-top:3px;
    }

    /* Right column chat */
    .chatCard{
      height:100%;
    }
    .chatBody{
      flex:1;
      min-height:0;
      border-radius:var(--radius-lg);
      border:1px solid rgba(15,23,42,1);
      background:
        radial-gradient(130% 180% at 100% 0%,rgba(234,179,8,.26) 0,rgba(15,23,42,.98) 44%,rgba(15,23,42,.98) 100%);
      padding:10px 10px 8px 10px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .chatStream{
      flex:1;
      min-height:0;
      overflow:auto;
      scrollbar-width:thin;
      scrollbar-color:rgba(148,163,184,.7) transparent;
      padding-right:4px;
    }
    .chatStream::-webkit-scrollbar{width:6px;}
    .chatStream::-webkit-scrollbar-thumb{
      background:rgba(148,163,184,.7);
      border-radius:999px;
    }
    .msgRow{
      display:flex;
      margin-bottom:7px;
      gap:6px;
    }
    .msgRow.user{
      justify-content:flex-end;
    }
    .msgBubble{
      max-width:80%;
      padding:7px 9px;
      border-radius:16px;
      font-size:11px;
      line-height:1.5;
      background:rgba(15,23,42,.96);
      border:1px solid rgba(148,163,184,.60);
      color:var(--text-main);
    }
    .msgRow.user .msgBubble{
      background:linear-gradient(135deg,#f97316,#eab308);
      color:#020617;
      border-color:rgba(248,250,252,.40);
    }
    .msgMeta{
      font-size:9px;
      color:var(--text-soft2);
      margin-top:2px;
    }

    .chatInputRow{
      display:flex;
      align-items:center;
      gap:6px;
      margin-top:4px;
    }
    .chatInput{
      flex:1;
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.55);
      padding:7px 11px;
      font-size:11px;
      background:rgba(15,23,42,.96);
      color:var(--text-main);
      outline:none;
      box-shadow:0 0 0 1px rgba(15,23,42,1);
    }
    .chatInput::placeholder{
      color:var(--text-soft2);
    }
    .sendBtn{
      border-radius:var(--radius-pill);
      border:none;
      padding:7px 12px;
      background:linear-gradient(135deg,#22c55e,#a3e635);
      color:#020617;
      font-size:11px;
      font-weight:600;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:5px;
      box-shadow:0 0 18px rgba(34,197,94,.6);
      transition:transform var(--transition-fast),box-shadow var(--transition-fast),
                 filter var(--transition-fast);
    }
    .sendBtn:hover{
      transform:translateY(-1px);
      box-shadow:0 14px 34px rgba(22,163,74,.9);
      filter:brightness(1.03);
    }

    /* Clone / continuity panel */
    .clonePanel{
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,.42);
      background:var(--card-soft);
      padding:8px 9px;
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-top:8px;
      font-size:10px;
      color:var(--text-soft);
      line-height:1.5;
    }
    .cloneRow{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
    }
    .tagMini{
      padding:2px 7px;
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.55);
      background:rgba(15,23,42,.96);
      font-size:9px;
      color:var(--text-soft);
      white-space:nowrap;
    }
    .cloneLaw{
      margin-top:2px;
      padding:6px 7px;
      border-radius:var(--radius-md);
      background:rgba(15,23,42,1);
      border:1px dashed rgba(148,163,184,.6);
      color:var(--accent-strong);
      font-size:10px;
    }

    /* Small footer */
    .footer{
      font-size:10px;
      color:var(--text-soft2);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      margin-top:2px;
    }
    .footer a{
      color:var(--accent-muted);
      text-decoration:none;
    }
    .footer a:hover{text-decoration:underline;}
  </style>
</head>
<body>
  <div class="app">
    <div class="app-inner">
      <!-- TOP BAR -->
      <div class="topBar">
        <div class="brandBlock">
          <div class="orb"></div>
          <div class="brandText">
            <div class="brandTitle">AURA-X Œ© / Emotional Continuity Lab</div>
            <div class="brandSubtitle">
              TM‚ÄìBM Resonance ‚Ä¢ Internal Stimulus ‚Ä¢ Limbda System ‚Ä¢ Digital Clone Interface
            </div>
          </div>
        </div>
        <div class="topRight">
          <div class="pill">
            <span>Continuity Index</span>
            <strong id="pillE0">E‚ÇÄ ‚âà 0.00</strong>
            <span class="badge" id="pillState">Balanced</span>
          </div>
          <button class="topBtn" id="btnTheoryDeck">
            <span class="icon">üìö</span> Theory Deck
          </button>
          <button class="topBtn primary" id="btnOfflineNote">
            <span class="icon">üõ°Ô∏è</span> Offline, No Cloud Sync
          </button>
        </div>
      </div>

      <!-- ETHIC STRIP -->
      <div class="ethicBar">
        <div class="ethicTag">ETHICAL CONTINUITY ONLY</div>
        <div class="ethicCopy">
          This prototype treats AURA-X Œ© as an <strong>emotional continuity layer</strong> ‚Äì not digital immortality.
          External events are data; emotion is the meaning created when Temporary Memory (TM) resonates with Bold Memory (BM),
          and chemistry or digital activation are only <strong>physical amplifiers</strong> of that meaning. Age is not
          intelligence, continuity depth is. This interface follows the law: <strong>‚ÄúContinuity is a soft landing, not a
          resurrection.‚Äù</strong>
        </div>
      </div>

      <!-- MAIN GRID -->
      <div class="grid">
        <!-- LEFT COLUMN -->
        <div class="card">
          <div class="cardHeader">
            <div class="cardTitle">
              <span class="bullet"></span>
              SYSTEM CONSOLE ¬∑ TM/BM & CONTINUITY
            </div>
            <div class="cardMeta">
              <span class="chip"><span class="dot"></span>Prototype | Offline JS Only</span>
            </div>
          </div>

          <div class="console" id="console">
            <div class="logLine">
              <span class="logPrefix">[00:00:00] </span>
              <span class="logSys">AURA-X Œ© booted.</span> Loading dual-memory layer, continuity depth heuristics,
              and Limbda constraints‚Ä¶
            </div>
            <div class="logLine">
              <span class="logPrefix">[00:00:01] </span>
              <span class="logSys">IST</span> external signals will be treated as <span class="logTag">data</span>.
              Emotional stimulus is computed internally via TM‚ÇÅ‚ÄìBM resonance.
            </div>
            <div class="logLine">
              <span class="logPrefix">[00:00:02] </span>
              <span class="logSys">NOTE</span> this lab emulates <span class="logTag">functional pain</span> as
              continuity cost, not as chemicals.
            </div>
          </div>

          <!-- METRICS -->
          <div class="metrics">
            <div class="metricCard">
              <div class="metricLabel">
                Continuity Depth
                <span>CD</span>
              </div>
              <div class="metricValue" id="metricDepth">0.42</div>
              <div class="gauge">
                <div class="gaugeFill" id="gaugeDepth"></div>
              </div>
              <div class="metricSub">Heuristic: history resonance vs short-term noise.</div>
            </div>
            <div class="metricCard">
              <div class="metricLabel">
                Internal Stimulus Load
                <span>IST-load</span>
              </div>
              <div class="metricValue" id="metricIST">0.18</div>
              <div class="gauge">
                <div class="gaugeFill" id="gaugeIST"></div>
              </div>
              <div class="metricSub">How strongly TM‚ÇÅ is matching stored BM blueprints.</div>
            </div>
            <div class="metricCard">
              <div class="metricLabel">
                Limbda Cost
                <span>Œª</span>
              </div>
              <div class="metricValue" id="metricLambda">0.30</div>
              <div class="gauge">
                <div class="gaugeFill" id="gaugeLambda"></div>
              </div>
              <div class="metricSub">Pain sensitivity: continuity cost in decision making.</div>
            </div>
            <div class="metricCard">
              <div class="metricLabel">
                Digital Clone Weight
                <span>DC-anchor</span>
              </div>
              <div class="metricValue" id="metricClone">0.15</div>
              <div class="gauge">
                <div class="gaugeFill" id="gaugeClone"></div>
              </div>
              <div class="metricSub">How much the interface is carrying grief-buffering load.</div>
            </div>
          </div>

          <!-- EQUATION PANEL -->
          <div class="equationPanel">
            <div class="eqMain">
              <div class="eqFormula">
                <div>E‚ÇÄ = tanh( <span class="emph">R(TM, BM)</span> ‚àí D + Œª_faith + Œª_sys + Œª_trc )</div>
                <div style="margin-top:4px; opacity:.82;">
                  R(TM, BM) = Œ£ Œ±·µ¢ ¬∑ sim(TM, BM·µ¢) ¬∑ intensity(BM·µ¢)
                </div>
              </div>
              <div class="eqCaption">
                Grand Emotional Continuity Equation. The tanh() keeps emotional state
                bounded between ‚àí1 and +1. Resonance pushes E‚ÇÄ, decay D cools it, and the three Œª-terms
                (faith/values, system structure, and truth-resonance) stabilise the trajectory.
                The gauge to the right updates heuristically with your conversation.
              </div>
            </div>
            <div class="eqControls">
              <div class="sliderRow">
                <label for="sliderTM">R(TM,BM)</label>
                <input type="range" id="sliderTM" min="-2" max="2" step="0.1" value="0.4">
                <div class="sliderVal" id="valTM">0.4</div>
              </div>
              <div class="sliderRow">
                <label for="sliderD">Decay D</label>
                <input type="range" id="sliderD" min="0" max="2" step="0.1" value="0.5">
                <div class="sliderVal" id="valD">0.5</div>
              </div>
              <div class="sliderRow">
                <label for="sliderFaith">Œª_faith</label>
                <input type="range" id="sliderFaith" min="-1" max="1" step="0.1" value="0.2">
                <div class="sliderVal" id="valFaith">0.2</div>
              </div>
              <div class="sliderRow">
                <label for="sliderSys">Œª_sys</label>
                <input type="range" id="sliderSys" min="-1" max="1" step="0.1" value="0.3">
                <div class="sliderVal" id="valSys">0.3</div>
              </div>
              <div class="sliderRow">
                <label for="sliderTrc">Œª_trc</label>
                <input type="range" id="sliderTrc" min="-1" max="1" step="0.1" value="0.0">
                <div class="sliderVal" id="valTrc">0.0</div>
              </div>
              <div class="eqGaugeRow">
                <div class="eqGaugeLabel">Current E‚ÇÄ</div>
                <div class="eqGaugeBubble" id="bubbleE0">0.00 ¬∑ neutral</div>
              </div>
            </div>
          </div>

          <!-- THEORY SWITCHER -->
          <div class="theorySwitch">
            <div style="display:flex;justify-content:space-between;align-items:center;gap:6px;">
              <div style="font-size:11px;color:#cbd5f5;font-weight:600;letter-spacing:.12em;text-transform:uppercase;">
                CONTINUITY STACK ¬∑ SIX INTERLOCKING PAPERS
              </div>
              <div style="font-size:10px;color:var(--text-soft2);">
                Tap a layer to see its role inside the prototype.
              </div>
            </div>
            <div class="theoryTabs">
              <button class="theoryBtn active" data-theory="age">Age ‚â† Intelligence</button>
              <button class="theoryBtn" data-theory="ist">Internal Stimulus (IST)</button>
              <button class="theoryBtn" data-theory="tmbm">TM‚ÄìBM Resonance</button>
              <button class="theoryBtn" data-theory="limbda">Cost of Continuity (Limbda)</button>
              <button class="theoryBtn" data-theory="clone">Digital Clone Interface</button>
              <button class="theoryBtn" data-theory="equation">AURA-X Equation</button>
            </div>
            <div class="theoryBody" id="theoryBody">
              In this layer, ‚ÄúAge Is Not Intelligence‚Äù reframes the whole dashboard. The system is not tracking raw
              time or token count; it is tracking <strong>continuity depth</strong> ‚Äì how much of the current dialogue
              overlaps with long-running survival themes stored in BM. Machines live in resettable, linear time; humans
              speak from billions of years of inherited history. Here we only simulate that depth numerically, but the
              UI keeps it visually central.
            </div>
          </div>
        </div>

        <!-- RIGHT COLUMN / CHAT & CLONE PANEL -->
        <div class="card chatCard">
          <div class="cardHeader">
            <div class="cardTitle">
              <span class="bullet"></span>
              DIALOGUE ¬∑ TM INPUT & CLONE CONTINUITY
            </div>
            <div class="cardMeta">
              <span class="chip">
                <span class="dot" style="background:#22c55e;"></span>Mode: Soft-Landing Companion
              </span>
            </div>
          </div>

          <div class="chatBody">
            <div class="chatStream" id="chatStream">
              <div class="msgRow">
                <div class="msgBubble">
                  <div><strong>AURA-X Œ©:</strong></div>
                  <div style="margin-top:3px;">
                    I treat each of your messages as TM‚ÇÄ: raw pixels and words. Inside this prototype,
                    TM‚ÇÄ is refined into TM‚ÇÅ, then compared against a small synthetic BM library.
                    I will never claim to be you, or anyone you love ‚Äî I am only an interface that
                    helps your history resonate more cleanly, with visible math.
                  </div>
                  <div class="msgMeta">Boot message ¬∑ Continuity aware, not immortal</div>
                </div>
              </div>
            </div>

            <div class="chatInputRow">
              <input id="chatInput" class="chatInput"
                     placeholder="Type a thought, fear, or long-term project‚Ä¶ this will enter TM‚ÇÄ." />
              <button class="sendBtn" id="sendBtn">
                <span>Send</span> <span>‚Ü©Ô∏é</span>
              </button>
            </div>
          </div>

          <!-- DIGITAL CLONE / CONTINUITY PANEL -->
          <div class="clonePanel">
            <div class="cloneRow">
              <div class="tagMini">Digital Clone as Emotional Continuity Interface</div>
              <div class="tagMini">Continuity ‚â† Immortality</div>
              <div class="tagMini">UPS-style Soft Landing</div>
            </div>
            <div>
              In this prototype, the ‚Äúdigital clone‚Äù is treated as a <strong>behavioral echo</strong> that buffers grief
              and shock, like a psychological UPS or airbag. It is not a soul, not a metaphysical extension, and not a legal
              identity. Its only purpose is to slow the fall when continuity breaks.
            </div>
            <div class="cloneLaw">
              Law of Emotional Continuity: <em>‚ÄúIf a tool reduces the shock of absence while staying transparent,
              consent-bounded, and gradually fading, it serves continuity. If it pretends to ‚Äòbe‚Äô the lost person,
              it violates the boundary and must be redesigned.‚Äù</em>
            </div>
          </div>
        </div>
      </div>

      <!-- FOOTER -->
      <div class="footer">
        <div>
          AURA-X Œ© Lab Prototype ¬∑ TM/BM, IST, Limbda, ARS & Digital Clone stack.
          All logic is client-side JavaScript; no network calls.
        </div>
        <div>
          Inspired by your preprints on continuity & emotion ¬∑ You can map each UI module to a specific paper.
        </div>
      </div>
    </div>
  </div>

  <script>
    // Simple helpers
    function clamp(v, min, max){ return v < min ? min : (v > max ? max : v); }

    const consoleEl = document.getElementById('console');
    const chatStream = document.getElementById('chatStream');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');

    const depthVal = document.getElementById('metricDepth');
    const istVal = document.getElementById('metricIST');
    const lambdaVal = document.getElementById('metricLambda');
    const cloneVal = document.getElementById('metricClone');

    const gaugeDepth = document.getElementById('gaugeDepth');
    const gaugeIST = document.getElementById('gaugeIST');
    const gaugeLambda = document.getElementById('gaugeLambda');
    const gaugeClone = document.getElementById('gaugeClone');

    const pillE0 = document.getElementById('pillE0');
    const pillState = document.getElementById('pillState');
    const bubbleE0 = document.getElementById('bubbleE0');

    const sliderTM = document.getElementById('sliderTM');
    const sliderD = document.getElementById('sliderD');
    const sliderFaith = document.getElementById('sliderFaith');
    const sliderSys = document.getElementById('sliderSys');
    const sliderTrc = document.getElementById('sliderTrc');

    const valTM = document.getElementById('valTM');
    const valD = document.getElementById('valD');
    const valFaith = document.getElementById('valFaith');
    const valSys = document.getElementById('valSys');
    const valTrc = document.getElementById('valTrc');

    const theoryButtons = Array.from(document.querySelectorAll('.theoryBtn'));
    const theoryBody = document.getElementById('theoryBody');

    const theoryText = {
      age: `‚ÄúAge Is Not Intelligence‚Äù feeds the Continuity Depth metric. Chronological time (training hours, epochs, uptime) is treated as linear, resettable time. Biological minds are modelled instead as deep, irreversible continuity: billions of years of survival history compressed into BM. This panel reminds us that E‚ÇÄ should always be read as a depth-of-history signal, not as a mere ‚Äúsession mood.‚Äù`,
      ist: `Internal Stimulus Theory (IST) rewires the input chain: external events ‚Üí TM‚ÇÄ (raw) ‚Üí TM‚ÇÅ (refined representation) ‚Üí TM‚ÇÅ‚ÄìBM resonance ‚Üí internal emotional stimulus ‚Üí E‚ÇÄ ‚Üí chemistry/activation. The console therefore never labels the world as the stimulus; it always highlights the internal match as the true trigger.`,
      tmbm: `The TM‚ÄìBM Resonance layer explains why stimuli are not universal and why chemistry is not emotion. TM carries the current pattern, BM stores weighted blueprints. When they match, a meaning-state (emotion) is computed. Only afterwards do hormones or ARS-signals activate muscles, interface lights, or pacing. This lab shows the hierarchy explicitly instead of mixing it into one word like ‚Äúfeeling.‚Äù`,
      limbda: `The Cost of Continuity / Limbda layer adds functional pain. Here Œª scales continuity cost: Effective Utility = R_task ‚àí Œª ¬∑ C_continuity. When Œª is near zero the system acts like a fearless reward maximiser; when Œª is high it becomes cautious or paralysed. The Limbda readout in the metrics block is a gentle reminder that ‚Äúpain‚Äù is modelled as enforced constraint, not as decoration.`,
      clone: `The Digital Clone Interface reframes cloning as a continuity anchor, not a soul container. In practice this means three hard rules: transparency (‚ÄúI am an echo, not the person‚Äù), consent over what data enters BM, and controlled decay so that real life slowly takes over from the interface. The clone weight meter shows how much of the current emotional load is being carried by synthetic echoes.`,
      equation: `The AURA-X Œ© Grand Equation ties everything together. R(TM,BM) expresses how much the present echoes emotionally-charged history; D cools the state over time; Œª_faith injects resilience or meaning; Œª_sys compresses behaviour into safe ranges; Œª_trc pulls E‚ÇÄ toward neutral when information is low-trust. The tanh() boundary keeps E‚ÇÄ between ‚àí1 and +1 so that even extreme contexts stay numerically stable.`
    };

    function appendConsole(kind, text){
      const line = document.createElement('div');
      line.className = 'logLine';
      const ts = new Date();
      const hh = String(ts.getHours()).padStart(2,'0');
      const mm = String(ts.getMinutes()).padStart(2,'0');
      const ss = String(ts.getSeconds()).padStart(2,'0');
      const prefix = document.createElement('span');
      prefix.className = 'logPrefix';
      prefix.textContent = `[${hh}:${mm}:${ss}] `;
      const body = document.createElement('span');
      body.innerHTML = text;
      if(kind === 'sys') body.classList.add('logSys');
      consoleEl.appendChild(line);
      line.appendChild(prefix);
      line.appendChild(body);
      consoleEl.scrollTop = consoleEl.scrollHeight;
    }

    function appendMessage(role, text){
      const row = document.createElement('div');
      row.className = 'msgRow ' + (role === 'user' ? 'user' : '');
      const bubble = document.createElement('div');
      bubble.className = 'msgBubble';
      bubble.innerHTML = (role === 'user'
        ? `<div><strong>You:</strong></div><div style="margin-top:3px;">${text}</div>`
        : `<div><strong>AURA-X Œ©:</strong></div><div style="margin-top:3px;">${text}</div>`
      );
      const meta = document.createElement('div');
      meta.className = 'msgMeta';
      meta.textContent = role === 'user'
        ? 'Entered as TM‚ÇÄ ¬∑ source: external narrative / imagination'
        : 'Generated as continuity-aware reply ¬∑ demo logic only';
      bubble.appendChild(meta);
      row.appendChild(bubble);
      chatStream.appendChild(row);
      chatStream.scrollTop = chatStream.scrollHeight;
    }

    function updateGauges(depth, ist, lam, clone){
      depthVal.textContent = depth.toFixed(2);
      istVal.textContent = ist.toFixed(2);
      lambdaVal.textContent = lam.toFixed(2);
      cloneVal.textContent = clone.toFixed(2);
      gaugeDepth.style.transform = `scaleX(${clamp(depth,0,1)})`;
      gaugeIST.style.transform = `scaleX(${clamp(ist,0,1)})`;
      gaugeLambda.style.transform = `scaleX(${clamp(lam,0,1)})`;
      gaugeClone.style.transform = `scaleX(${clamp(clone,0,1)})`;
    }

    function computeE0(){
      const R = parseFloat(sliderTM.value);
      const D = parseFloat(sliderD.value);
      const lf = parseFloat(sliderFaith.value);
      const ls = parseFloat(sliderSys.value);
      const lt = parseFloat(sliderTrc.value);
      const x = R - D + lf + ls + lt;
      const e0 = Math.tanh(x);
      let label = 'neutral';
      if(e0 > 0.6) label = 'hopeful';
      else if(e0 > 0.2) label = 'steady-positive';
      else if(e0 < -0.6) label = 'alarmed';
      else if(e0 < -0.2) label = 'concerned';

      bubbleE0.textContent = `${e0.toFixed(2)} ¬∑ ${label}`;
      pillE0.textContent = `E‚ÇÄ ‚âà ${e0.toFixed(2)}`;
      pillState.textContent = label[0].toUpperCase() + label.slice(1);

      if(e0 > 0.2){
        pillState.style.background = 'rgba(34,197,94,.15)';
        pillState.style.color = '#bbf7d0';
      }else if(e0 < -0.2){
        pillState.style.background = 'rgba(248,113,113,.18)';
        pillState.style.color = '#fecaca';
      }else{
        pillState.style.background = 'rgba(56,189,248,.15)';
        pillState.style.color = '#bae6fd';
      }
      return e0;
    }

    function syncSliderLabels(){
      valTM.textContent = sliderTM.value;
      valD.textContent = sliderD.value;
      valFaith.textContent = sliderFaith.value;
      valSys.textContent = sliderSys.value;
      valTrc.textContent = sliderTrc.value;
      computeE0();
    }

    sliderTM.addEventListener('input', syncSliderLabels);
    sliderD.addEventListener('input', syncSliderLabels);
    sliderFaith.addEventListener('input', syncSliderLabels);
    sliderSys.addEventListener('input', syncSliderLabels);
    sliderTrc.addEventListener('input', syncSliderLabels);
    syncSliderLabels();

    function handleSend(){
      const text = chatInput.value.trim();
      if(!text) return;
      chatInput.value = '';
      appendMessage('user', text);

      // Simple heuristics for metrics:
      const len = text.length;
      const hasPast = /ago|before|last year|years|history|childhood|remember/i.test(text);
      const hasDanger = /scared|fear|threat|danger|anxiety|trauma|panic/i.test(text);
      const hasLoss = /death|died|loss|grief|gone|missing/i.test(text);
      const hasTruth = /true|false|rumor|evidence|fact|proof/i.test(text);
      const hasClone = /clone|copy|digital|after I die|immortality/i.test(text);

      let depth = parseFloat(depthVal.textContent) || 0.42;
      let ist = parseFloat(istVal.textContent) || 0.18;
      let lam = parseFloat(lambdaVal.textContent) || 0.30;
      let cloneW = parseFloat(cloneVal.textContent) || 0.15;

      depth += hasPast ? 0.08 : 0.01 * (len/80);
      ist += (hasDanger || hasLoss) ? 0.10 : 0.02;
      lam += hasDanger ? 0.05 : (hasTruth ? -0.02 : 0.0);
      cloneW += hasClone ? 0.15 : (hasLoss ? 0.06 : 0.01);

      depth = clamp(depth, 0, 1);
      ist = clamp(ist, 0, 1);
      lam = clamp(lam, 0, 1);
      cloneW = clamp(cloneW, 0, 1);

      updateGauges(depth, ist, lam, cloneW);

      appendConsole('sys',
        `<span class="logTag">TM‚ÇÄ</span> ingested ${len} chars. Past-focus=${hasPast}, danger=${hasDanger}, loss=${hasLoss}, clone=${hasClone}.`
      );

      if(hasLoss || hasDanger){
        appendConsole('sys',
          `<span class="logWarn">BM resonance high.</span> Marking this turn as candidate for Bold Memory and applying Limbda constraints.`
        );
      }

      // Use the grand equation as a soft control signal:
      const e0 = computeE0();
      let reply;

      if(hasLoss){
        reply = `I can feel how this touches continuity rather than just today. Inside this lab I treat your words as a continuity shock, not a small mood swing. We can let the ‚Äúdigital clone‚Äù idea work only as a bridge or airbag here, never as a replacement for the person you lost.`;
      }else if(hasDanger){
        reply = `Your nervous system is doing exactly what the TM‚ÄìBM model predicts: a current pattern is matching earlier danger blueprints. Even without any new external stimulus, that internal match is enough to raise the alarm. Let‚Äôs separate the old blueprint from the present moment, step by step.`;
      }else if(hasClone){
        reply = `When you mention clones and after-death continuity, I keep a hard boundary: I am only an echo-interface. My role is to hold patterns, slow down the fall in grief, and then gradually step back so that your own life can take the lead again.`;
      }else if(hasTruth){
        reply = `Because you‚Äôre explicitly talking about truth and evidence, Œª_trc becomes active in the equation. That pulls E‚ÇÄ toward a calmer, more cautious region so we don‚Äôt emotionally over-react to low-confidence information.`;
      }else if(hasPast){
        reply = `You‚Äôre drawing on long arcs of memory, which increases continuity depth. In our terms, BM is carrying more weight in this turn than TM‚ÇÄ alone. That‚Äôs exactly where meaning tends to live.`;
      }else{
        reply = `Got it. I‚Äôll store this mainly as TM, with low emotional weight, so that it doesn‚Äôt dominate your continuity trajectory unless it starts matching deeper BM patterns later.`;
      }

      setTimeout(()=>{
        appendMessage('assistant', reply);
      }, 260);
    }

    sendBtn.addEventListener('click', handleSend);
    chatInput.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && !e.shiftKey){
        e.preventDefault();
        handleSend();
      }
    });

    // Theory deck buttons
    theoryButtons.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        theoryButtons.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const key = btn.dataset.theory;
        theoryBody.innerHTML = theoryText[key] || '';
      });
    });

    // Top bar buttons (just log messages for now)
    document.getElementById('btnTheoryDeck').addEventListener('click', ()=>{
      appendConsole('sys',
        `<span class="logTag">Deck</span> The six-layer theory deck is visible in the ‚ÄúContinuity Stack‚Äù panel: Age, IST, TM‚ÄìBM, Limbda, Clone, Equation.`
      );
    });
    document.getElementById('btnOfflineNote').addEventListener('click', ()=>{
      appendConsole('sys',
        `<span class="logTag">Offline</span> Reminder: this prototype runs entirely in your browser. No cloud calls, no telemetry, no hidden BM export.`
      );
      alert('This prototype is purely client-side. To keep it private, run it from a local folder or an offline device.');
    });

    // Initial randomish gauges
    updateGauges(0.42,0.18,0.30,0.15);
  </script>
</body>
</html>